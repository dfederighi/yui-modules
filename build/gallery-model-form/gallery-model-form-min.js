YUI.add("gallery-model-form",function(e,t){e.ModelForm=e.Base.create("model-form",e.Widget,[],{initializer:function(t){this._fields=[],this._eventHandles=[],t.values&&(this._formValues=t.values),this.set("model",new e.Model),this._eventHandles.push(this.get("model").on("change",this._handleModelChange,this))},destructor:function(){(new e.EventHandle(this._eventHandles)).detach(),this.form&&this.form.destroy()},renderUI:function(){this.get("markup")&&this.get("contentBox").setHTML(e.Node.create(this.get("markup"))),this.form=this.get("boundingBox").one("form"),this._parseFields()},getField:function(e){return this._fields[e]},getForm:function(){return this.form},reset:function(t){this.get("model").reset(),t||e.Object.isEmpty(this._formValues)||this.get("model").setAttrs(this._formValues)},_handleModelChange:function(t){if(t.src==="form")return;e.Object.each(t.changed,function(t,n){var r=this.getField(n);e.Lang.isUndefined(r)||(r.get("type")==="checkbox"?r.set("checked",t.newVal):r.get("type")==="radio"?e.all("input[name="+n+"]").each(function(e){e.get("value")===t.newVal&&e.set("checked",!0)},this):r.set("value",t.newVal))},this)},_parseFields:function(){var t=this.get("boundingBox").one("form").all("*"),n=this.get("model"),r={};t.each(function(e){var t=e.get("nodeName"),i=e.get("type"),s=e.get("name");t==="INPUT"?(i==="text"?this._eventHandles.push(e.after("keyup",function(e){n.set(s,e.target.get("value"),{src:"form"})},this)):i==="checkbox"?this._eventHandles.push(e.after("click",function(e){n.set(s,e.target.get("checked"),{src:"form"})},this)):i==="radio"&&this._eventHandles.push(e.on("change",function(e){n.set(s,e.target.get("value"),{src:"form"})},this)),this._fields[s]=e,r[s]=e.get("value")):t==="SELECT"?(this._eventHandles.push(e.after("change",function(e){n.set(s,e.target.get("value"),{src:"form"})},this)),this._fields[s]=e,r[s]=e.get("value")):t==="TEXTAREA"?(this._eventHandles.push(e.on("keyup",function(e){n.set(s,e.target.get("value"),{src:"form"})})),this._fields[s]=e,r[s]=e.get("value")):t==="BUTTON"&&(this._eventHandles.push(e.on("click",function(e){n.set(s,e.target.get("value"),{src:"form"})})),this._fields[s]=e,r[s]=e.get("value"))},this),e.Object.each(this._fields,function(e,t){n.get(t)||n.set(t,"",{silent:!0})}),e.Object.isEmpty(this._formValues)?e.Object.isEmpty(r)||n.setAttrs(r):n.setAttrs(this._formValues)}},{ATTRS:{markup:{value:""},model:{value:null}}})},"@VERSION@",{requires:["yui-base","node","event","model"]});
